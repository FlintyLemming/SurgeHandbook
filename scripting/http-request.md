# HTTP è¯·æ±‚

> ğŸ’¡**æœ¬é¡µæ–‡æ¡£æ¥è‡ª**[**å®˜æ–¹ç¤¾åŒº**](https://community.nssurge.com/d/33-scripting)

ç”¨äºä¿®æ”¹ HTTP è¯·æ±‚ä½“ï¼Œè¯¥ç±»å‹ä¸‹ç¬¬äºŒå‚æ•°ä¸ºåŒ¹é… URL çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¢«åŒ¹é…åˆ°çš„è¯·æ±‚ä¼šè¢«æ‰§è¡Œè„šæœ¬ã€‚

ä¼ å…¥å‚æ•°ä¸º `$request`ï¼Œå­—æ®µä¸º

* `$request.url<String>`ï¼šè¯·æ±‚çš„ URL
* `$request.body<String>`ï¼šè¯·æ±‚çš„ Bodyï¼Œä»¥ UTF-8 è§£ç åçš„å­—ç¬¦ä¸²ï¼Œä»…å½“ requires-body = true æ—¶æœ‰æ•ˆ
* `$request.method<String>`ï¼šè¯·æ±‚çš„ HTTP æ–¹æ³•
* `$request.headers<Object>`ï¼šè¯·æ±‚çš„ Header

åº”æ‰§è¡Œ `$done` è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯é€‰åŒ…å«å­—æ®µï¼š

* `url<String>`ï¼šä½¿ç”¨è¯¥ URL è¦†ç›–åŸè¯·æ±‚çš„ URLï¼Œæ³¨æ„ä½¿ç”¨è„šæœ¬ä¿®æ”¹ URL æ—¶ä¸ä¼šåƒ URL Rewrite é‚£æ ·è‡ªåŠ¨è°ƒæ•´ Header çš„ Host å­—æ®µï¼Œå¦‚æœéœ€è¦è°ƒæ•´éœ€è¦æ‰‹åŠ¨è¿”å›æ–°çš„ headers å­—æ®µ
* `headers<Object>`ï¼šä½¿ç”¨è¯¥ headers è¯å…¸å®Œå…¨è¦†ç›–åŸæ¥çš„ headersï¼Œæ³¨æ„éƒ¨åˆ† HTTP ç‰¹æ®Šå­—æ®µä¸å¯è¢«ä¿®æ”¹ï¼Œå¦‚ Content-Length
* `body<String>`ï¼šä½¿ç”¨è¯¥ body è¦†ç›–åŸæ¥çš„è¯·æ±‚ bodyï¼Œä»…å½“ requires-body = true æ—¶æœ‰æ•ˆã€‚
* `response<Object>`ï¼šå¦‚æœè¿”å›äº†è¯¥å­—æ®µï¼Œåˆ™è¡¨ç¤ºåº”ç›´æ¥è¿”å›è¯¥ç»“æœè€Œä¸è¿›è¡Œå®é™…çš„ç½‘ç»œè¯·æ±‚ï¼Œä»…å½“ requires-body = false æ—¶æœ‰æ•ˆã€‚å¯åŒ…å«ä¸‰ä¸ªå­—æ®µï¼š
  * `status<Number>`: å“åº”çš„ HTTP çŠ¶æ€ç ã€‚
  * `headers<Object>`: å“åº”çš„ HTTP Headersã€‚
  * `body<String>`: å“åº”çš„ HTTP Bodyï¼Œå°†ä»¥ UTF-8 ç¼–ç åè¿”å›ã€‚

ä½¿ç”¨ `$done();` è¡¨ç¤ºç»ˆæ­¢è¯¥è¯·æ±‚ï¼Œä½¿ç”¨ `$done({});` è¡¨ç¤ºä¸å¯¹è¯¥è¯·æ±‚è¿›è¡Œä¿®æ”¹ã€‚

å½“å‰ç‰ˆæœ¬çš„ä¸€äº›é™åˆ¶ï¼š

* å½“è¯·æ±‚ä½¿ç”¨ chunked encoding ä¸Šä¼  body æ—¶ï¼Œä¸å¯ä»¥è¿›è¡Œ body ä¿®æ”¹ã€‚
* å½“ Expect: 100-continue å­˜åœ¨æ—¶ï¼Œä¸å¯ä»¥è¿›è¡Œ body ä¿®æ”¹ã€‚

ä¸€ä¸ªç®€å•æ ·ä¾‹

    let headers = $request.headers;
    headers['X-Modified-By'] = 'Surge';

    $done({headers});

æ³¨æ„æ ·ä¾‹ä½¿ç”¨äº† JS ES6 è¯­æ³•ã€‚

